## 🎯 概要 (Overview)

`rubi` プロジェクトの最初の実装フェーズです。
このイシューでは、コアとなる処理エンジンを構築し、主要機能である「手動モード (`:rubi`記法）」の実装を完了させることを目標とします。
すべての実装は `REQUIREMENTS.md` の仕様に基づきます。

## ✅ タスク詳細 (Task Breakdown)

-   [ ] **1. プロジェクトの雛形作成 (Scaffolding)**
    -   [ ] Goモジュールを初期化する (`go mod init github.com/takaryo1010/rubi`)
    -   [ ] 基本的なディレクトリ構造と `main.go` を作成する (例: `pkg/`, `cmd/rubi/`)

-   [ ] **2. CLIとファイル処理 (CLI & File Handling)**
    -   [ ] 入力ファイルパスを受け取るための基本的なコマンドライン引数パーサーを実装する
    -   [ ] 入力ファイルをバイトスライスとして読み込む機能を実装する

-   [ ] **3. 辞書読み込み (Dictionary Loading)**
    -   [ ] YAML辞書に対応するGoの構造体を定義する
    -   [ ] `dictionary.yaml` ファイルを読み込み、パースする関数を実装する

-   [ ] **4. ASTベースの処理 (AST-based Processing)**
    -   [ ] `github.com/yuin/goldmark` を導入し、入力をAST（抽象構文木）にパースする
    -   [ ] ASTを走査（ウォーク）し、`ast.KindText` ノードを特定するロジックを実装する

-   [ ] **5. 手動モードの実装 (Manual Mode Implementation)**
    -   [ ] `Text` ノード内で `:rubi` サフィックスを持つ単語 (例: `Vite:rubi`) を検索する
    -   [ ] 発見した単語を辞書でルックアップする
    -   [ ] 発見した場合、置換情報（開始/終了オフセット、置換後文字列）を構造体に格納し、リスト化する

-   [ ] **6. パッチ処理の実装 (Patcher Implementation)**
    -   [ ] 収集した置換情報のリストを、元のバイトスライスに適用する「パッチャー」を実装する
    -   [ ] **（重要）オフセットのズレを防ぐため、必ずファイルの末尾から先頭に向かって置換処理を行う**

-   [ ] **7. 出力処理 (Output Handling)**
    -   [ ] デフォルトの動作として、変更後の内容を標準出力に表示する
    -   [ ] `--write` (`-w`) フラグが指定された場合、入力ファイルを上書き保存する

-   [ ] **8. 初期テスト (Initial Testing)**
    -   [ ] 中核となるパッチ処理のロジックに対してユニットテストを追加する
    -   [ ] サンプルのMarkdownファイルと辞書を使った簡単な結合テストを追加する

## 📚 完了の定義 (Definition of Done)

-   CLIがMarkdownファイルを読み込める
-   CLIがYAML辞書をパースできる
-   `単語:rubi` という記述が正しく `<ruby>単語<rt>読み</rt></ruby>` に置換される
-   変更後の内容がデフォルトで標準出力に表示される
-   `-w` フラグ使用時にファイルが上書き保存される
-   `GEMINI.md` の定義通り、Go 1.21で開発されている
